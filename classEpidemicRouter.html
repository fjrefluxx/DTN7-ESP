<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>dtn7-esp: EpidemicRouter Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">dtn7-esp
   </div>
   <div id="projectbrief">An implementation of the Bundle Protocol Version 7 (RFC9171) for ESP32 microcontrollers using the ESP-IDF</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classEpidemicRouter-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">EpidemicRouter Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Epidemic router functionality. The epidemic router checks whether any nodes are in range, to which a bundle has not been forwarded, before broadcasting. This requires a peer discovery mechanism by the <a class="el" href="classCLA.html" title="generic bas class for all CLA&#39;s">CLA</a>, as provided by the LoRa <a class="el" href="classCLA.html" title="generic bas class for all CLA&#39;s">CLA</a> in BPoL-compatible mode. By default, it is expected that all nodes which are currently in the list of known neighbors, as produced by the <a class="el" href="classCLA.html" title="generic bas class for all CLA&#39;s">CLA</a>'s peer discovery mechanism, successfully receive a potential broadcast.  
 <a href="classEpidemicRouter.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="EpidemicRouter_8hpp_source.html">EpidemicRouter.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for EpidemicRouter:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classEpidemicRouter.png" usemap="#EpidemicRouter_map" alt=""/>
  <map id="EpidemicRouter_map" name="EpidemicRouter_map">
<area href="classRouter.html" alt="Router" shape="rect" coords="0,0,100,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab8bd187bc8634a1b2cc2dc1bc54de9e8" id="r_ab8bd187bc8634a1b2cc2dc1bc54de9e8"><td class="memItemLeft" align="right" valign="top"><a id="ab8bd187bc8634a1b2cc2dc1bc54de9e8" name="ab8bd187bc8634a1b2cc2dc1bc54de9e8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>EpidemicRouter</b> ()</td></tr>
<tr class="memdesc:ab8bd187bc8634a1b2cc2dc1bc54de9e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">default constructor <br /></td></tr>
<tr class="separator:ab8bd187bc8634a1b2cc2dc1bc54de9e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d74a8334b9de889ec5e308f0bde523" id="r_ab1d74a8334b9de889ec5e308f0bde523"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEpidemicRouter.html#ab1d74a8334b9de889ec5e308f0bde523">EpidemicRouter</a> (std::vector&lt; <a class="el" href="classCLA.html">CLA</a> * &gt; <a class="el" href="classRouter.html#a437b6e514e6b7fe57a4428d62d006889">clas</a>, <a class="el" href="classStorage.html">Storage</a> *storage)</td></tr>
<tr class="memdesc:ab1d74a8334b9de889ec5e308f0bde523"><td class="mdescLeft">&#160;</td><td class="mdescRight">generates an epidemic router  <br /></td></tr>
<tr class="separator:ab1d74a8334b9de889ec5e308f0bde523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c1f3abf9c18ef396b2519aa1201546" id="r_a98c1f3abf9c18ef396b2519aa1201546"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEpidemicRouter.html#a98c1f3abf9c18ef396b2519aa1201546">handleForwarding</a> (<a class="el" href="classBundleInfo.html">BundleInfo</a> *bundle, uint &amp;reasonCode) override</td></tr>
<tr class="memdesc:a98c1f3abf9c18ef396b2519aa1201546"><td class="mdescLeft">&#160;</td><td class="mdescRight">handles the forwarding of bundles as described in section 5.4 step 2 of RFC9171  <br /></td></tr>
<tr class="separator:a98c1f3abf9c18ef396b2519aa1201546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d6559e1c9da43bf2b28cbf112ee510b" id="r_a6d6559e1c9da43bf2b28cbf112ee510b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEpidemicRouter.html#a6d6559e1c9da43bf2b28cbf112ee510b">checkForwardedTo</a> (<a class="el" href="classNode.html">Node</a> toCheck, std::vector&lt; <a class="el" href="classNode.html">Node</a> &gt; &amp;forwardedTo, std::string bundleID)</td></tr>
<tr class="memdesc:a6d6559e1c9da43bf2b28cbf112ee510b"><td class="mdescLeft">&#160;</td><td class="mdescRight">checks whether a node is in a vector of forwarded to nodes and, if enabled in menuconfig: checks whether the <a class="el" href="classNode.html" title="This class represents a DTN node.">Node</a> has confirmed the reception of the given bundle ID in its last advertisement, if not, removes node from forwardedTO and returns false  <br /></td></tr>
<tr class="separator:a6d6559e1c9da43bf2b28cbf112ee510b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classRouter"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classRouter')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classRouter.html">Router</a></td></tr>
<tr class="memitem:a08b26e7f6b763934113eff22f8217892 inherit pub_methods_classRouter" id="r_a08b26e7f6b763934113eff22f8217892"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBundle.html">Bundle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRouter.html#a08b26e7f6b763934113eff22f8217892">prepareForSend</a> (<a class="el" href="classBundle.html">Bundle</a> *bundle)</td></tr>
<tr class="memdesc:a08b26e7f6b763934113eff22f8217892 inherit pub_methods_classRouter"><td class="mdescLeft">&#160;</td><td class="mdescRight">prepares bundle for forwarding, takes care off processing (cf. RFC 9171, 5.4 <a class="el" href="classBundle.html" title="Representation of a DTN7 bundle in accordance to RFC9171.">Bundle</a> Forwarding Step 4)  <br /></td></tr>
<tr class="separator:a08b26e7f6b763934113eff22f8217892 inherit pub_methods_classRouter"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4234fa1da0f6d68051324d8ed1e6a51 inherit pub_methods_classRouter" id="r_aa4234fa1da0f6d68051324d8ed1e6a51"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classReceivedBundle.html">ReceivedBundle</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRouter.html#aa4234fa1da0f6d68051324d8ed1e6a51">getNewBundles</a> ()</td></tr>
<tr class="memdesc:aa4234fa1da0f6d68051324d8ed1e6a51 inherit pub_methods_classRouter"><td class="mdescLeft">&#160;</td><td class="mdescRight">a method to poll all non-push CLAs for received bundles.  <br /></td></tr>
<tr class="separator:aa4234fa1da0f6d68051324d8ed1e6a51 inherit pub_methods_classRouter"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a969cd7ff6001bb7444a9383a03c6160a inherit pub_methods_classRouter" id="r_a969cd7ff6001bb7444a9383a03c6160a"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRouter.html#a969cd7ff6001bb7444a9383a03c6160a">sendToPreviousNode</a> (<a class="el" href="classBundle.html">Bundle</a> *bundle)</td></tr>
<tr class="memdesc:a969cd7ff6001bb7444a9383a03c6160a inherit pub_methods_classRouter"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a bundle back to its previous node, if it is known. As this is not useful for broadcast, they always returns false.  <br /></td></tr>
<tr class="separator:a969cd7ff6001bb7444a9383a03c6160a inherit pub_methods_classRouter"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_attribs_classRouter"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classRouter')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classRouter.html">Router</a></td></tr>
<tr class="memitem:a437b6e514e6b7fe57a4428d62d006889 inherit pub_attribs_classRouter" id="r_a437b6e514e6b7fe57a4428d62d006889"><td class="memItemLeft" align="right" valign="top">
std::vector&lt; <a class="el" href="classCLA.html">CLA</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>clas</b></td></tr>
<tr class="memdesc:a437b6e514e6b7fe57a4428d62d006889 inherit pub_attribs_classRouter"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointers to all stored <a class="el" href="classCLA.html" title="generic bas class for all CLA&#39;s">CLA</a> instances. <br /></td></tr>
<tr class="separator:a437b6e514e6b7fe57a4428d62d006889 inherit pub_attribs_classRouter"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Epidemic router functionality. The epidemic router checks whether any nodes are in range, to which a bundle has not been forwarded, before broadcasting. This requires a peer discovery mechanism by the <a class="el" href="classCLA.html" title="generic bas class for all CLA&#39;s">CLA</a>, as provided by the LoRa <a class="el" href="classCLA.html" title="generic bas class for all CLA&#39;s">CLA</a> in BPoL-compatible mode. By default, it is expected that all nodes which are currently in the list of known neighbors, as produced by the <a class="el" href="classCLA.html" title="generic bas class for all CLA&#39;s">CLA</a>'s peer discovery mechanism, successfully receive a potential broadcast. </p>
<p>This assumption might be acceptable in some cases, but will not always be true. For this reason, an experimental feature is included in this routing strategy and the LoRa <a class="el" href="classCLA.html" title="generic bas class for all CLA&#39;s">CLA</a> which allows to check whether the transmissions were actually successful, and to detect whether a bundle was forwarded to a neighboring node by any other node. This mechanism uses a set of hashes of bundle IDs which are transmitted in the advertisement messages ,see the LoRa <a class="el" href="classCLA.html" title="generic bas class for all CLA&#39;s">CLA</a>. If this feature is enabled, the nodes which are assumed to have received a given bundle are reevaluated at the start of the transmission attempt of the bundle and potentially removed from the list of nodes which have received the bundle, if the hash does not indicate a successful reception. The intervals in which bundles are evaluated for transmission, nodes advertise their presence and the time after which not recently seen nodes are removed from the known peers need to be adjusted to each other in order to have full benefit of this feature. Furthermore, the overall benefit of this feature should be evaluated for the desired application. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab1d74a8334b9de889ec5e308f0bde523" name="ab1d74a8334b9de889ec5e308f0bde523"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1d74a8334b9de889ec5e308f0bde523">&#9670;&#160;</a></span>EpidemicRouter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EpidemicRouter::EpidemicRouter </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classCLA.html">CLA</a> * &gt;&#160;</td>
          <td class="paramname"><em>clas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStorage.html">Storage</a> *&#160;</td>
          <td class="paramname"><em>storage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generates an epidemic router </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clas</td><td>CLAs the router should use </td></tr>
    <tr><td class="paramname">storage</td><td>storage class the router uses </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6d6559e1c9da43bf2b28cbf112ee510b" name="a6d6559e1c9da43bf2b28cbf112ee510b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d6559e1c9da43bf2b28cbf112ee510b">&#9670;&#160;</a></span>checkForwardedTo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EpidemicRouter::checkForwardedTo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNode.html">Node</a>&#160;</td>
          <td class="paramname"><em>toCheck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classNode.html">Node</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>forwardedTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>bundleID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>checks whether a node is in a vector of forwarded to nodes and, if enabled in menuconfig: checks whether the <a class="el" href="classNode.html" title="This class represents a DTN node.">Node</a> has confirmed the reception of the given bundle ID in its last advertisement, if not, removes node from forwardedTO and returns false </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">toCheck</td><td>the node which should be checked </td></tr>
    <tr><td class="paramname">forwardedTo</td><td>the list of nodes which the bundle has been forwarded to </td></tr>
    <tr><td class="paramname">bundleID</td><td>the ID of the bundle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the <a class="el" href="classNode.html" title="This class represents a DTN node.">Node</a> is in the forwarded to Vector and, if enabled, the reception of the BundleID was confirmed </dd></dl>

</div>
</div>
<a id="a98c1f3abf9c18ef396b2519aa1201546" name="a98c1f3abf9c18ef396b2519aa1201546"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98c1f3abf9c18ef396b2519aa1201546">&#9670;&#160;</a></span>handleForwarding()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool EpidemicRouter::handleForwarding </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBundleInfo.html">BundleInfo</a> *&#160;</td>
          <td class="paramname"><em>bundle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint &amp;&#160;</td>
          <td class="paramname"><em>reasonCode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>handles the forwarding of bundles as described in section 5.4 step 2 of RFC9171 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bundle</td><td>the bundle to forward </td></tr>
    <tr><td class="paramname">reasonCode</td><td>a reference to a uint in which to store the reason code if the forwarding was unsuccessful </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether the forwarding was successful </dd></dl>

<p>Implements <a class="el" href="classRouter.html#a27233c55a9fabdf72cfe4c6b720efd2f">Router</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>dtn7-esp/include/Routing/<a class="el" href="EpidemicRouter_8hpp_source.html">EpidemicRouter.hpp</a></li>
<li>dtn7-esp/src/Routing/<b>EpidemicRouter.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
